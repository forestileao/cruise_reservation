version: v1.0
name: "\U0001F3AF Simple CI Pipeline"
agent:
  machine:
    type: a2-standard-4
    os_image: macos-xcode15
  containers:
    - name: main
      image: 'registry.semaphoreci.com/node:20'
fail_fast:
  stop:
    when: branch != 'main'
auto_cancel:
  running:
    when: branch != 'main'
  queued:
    when: branch = 'main'
blocks:
  - name: "\U0001F9EA Test"
    task:
      jobs:
        - name: "\U0001F7E2 Run Tests"
          commands:
            - echo "Checking out code..."
            - echo "Installing dependencies..."
            - echo "Running test suite in container..."
            - echo "Tests completed successfully!"
  - name: "\U0001F433 Docker"
    dependencies:
      - "\U0001F9EA Test"
    task:
      jobs:
        - name: "\U0001F4E6 Build and Push"
          commands:
            - echo "Logging into Docker registry..."
            - echo "Building Docker image..."
            - echo "Pushing image to registry..."
            - echo "Docker image published successfully!"
  - name: "\U0001F680 Deploy"
    dependencies:
      - "\U0001F433 Docker"
    task:
      jobs:
        - name: "\U0001F30D Deploy to Production"
          commands:
            - echo "Preparing deployment..."
            - echo "Updating container version..."
            - echo "Rolling out new containers..."
            - echo "Deployment completed successfully!"
